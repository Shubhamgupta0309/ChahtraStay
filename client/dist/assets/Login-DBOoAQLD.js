import{r as d,A as L,u as A,j as e}from"./index-CbzP6hy5.js";import{B as b}from"./createLucideIcon-AdlLZUEa.js";import{C as F,b as P}from"./card-BI2sKOiD.js";import{I as l}from"./input-XUYr8Ntf.js";import{L as i}from"./label-D0bADn3j.js";import{T as q,a as D,b as j,c as y}from"./tabs-mbZmUTMi.js";import{A as f,a as N,C as I}from"./alert-Ch6P70e0.js";import{g as k,T as B,S as v}from"./toaster-CnzL-6es.js";import{C as w}from"./circle-check-big-CUKdeci9.js";import"./index-DwRZfiEm.js";import"./index-DYIKVHMg.js";class R extends Error{}R.prototype.name="InvalidTokenError";const K=()=>{const{login:u,signupUser:C}=d.useContext(L),S=A(),[m,p]=d.useState(!1),[n,o]=d.useState(""),[E,x]=d.useState("login"),{toast:c}=k(),g=async(s,h)=>{s.preventDefault(),p(!0),o("");const T=new FormData(s.target),r=Object.fromEntries(T.entries());try{if(h==="signup"){if(r.phone.length<10)return c({title:"Phone number should be at least 10 digits",variant:"destructive"});if(r.password.length<8)return c({title:"Password should be at least 8 characters long",variant:"destructive"});await C(r),c({title:"Account Created Successfully",description:`Welcome ${r.name}! Please log in to continue.`,icon:e.jsx(w,{className:"text-green-500"})}),s.target.reset(),x("login");return}const t=await u(r.email,r.password);c({title:"Welcome Back!",description:"You are now logged in.",icon:e.jsx(w,{className:"text-green-500"})}),S("/")}catch(t){let a="Something went wrong. Please try again.";o(t.message||a),console.log(t),t.status===409&&(a="User already exists. Please log in.",o(a)),t.status===400&&(a="Invalid credentials. Please try again.",o(a)),t.status===500&&(a="Server error. Please try again later.",o(a)),c({title:h==="signup"?"Registration Failed":"Login Failed",description:n,variant:"destructive",icon:e.jsx(I,{className:"text-red-500"})})}finally{p(!1)}};return document.title="Login | ChahtraStay",e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-purple-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs(F,{className:"w-full max-w-md shadow-xl rounded-2xl",children:[e.jsx(B,{}),e.jsxs(P,{className:"p-6 bg-white rounded-lg",children:[e.jsx("h2",{className:"text-center text-2xl font-bold text-purple-700",children:"ChahtraStay"}),e.jsx("p",{className:"text-center text-gray-600 mb-4",children:"Welcome! Sign in or create an account."}),e.jsxs("div",{className:"flex items-center justify-center gap-2 my-3 w-full",children:[e.jsx(v,{className:"flex-grow max-w-32 "}),e.jsx("span",{className:"text-gray-500 text-sm font-medium px-2",children:"OR"}),e.jsx(v,{className:"flex-grow max-w-32"})]}),e.jsxs(q,{defaultValue:"login",value:E,onValueChange:x,className:"w-full",children:[e.jsxs(D,{className:"grid w-full grid-cols-2 mb-6",children:[e.jsx(j,{value:"login",children:"Login"}),e.jsx(j,{value:"signup",children:"Sign Up"})]}),e.jsxs(y,{value:"login",children:[n&&e.jsx(f,{variant:"destructive",className:"mb-4",children:e.jsx(N,{children:n})}),e.jsxs("form",{onSubmit:s=>g(s,"login"),className:"space-y-4",children:[e.jsxs("div",{className:"mb-2 space-y-1",children:[e.jsx(i,{htmlFor:"emailLogin",className:"text-gray-700",children:"Email"}),e.jsx(l,{id:"emailLogin",type:"email",name:"email",placeholder:"Enter your email",required:!0,className:"border border-gray-300"})]}),e.jsxs("div",{className:"mb-2 space-y-1",children:[e.jsx(i,{htmlFor:"passLogin",className:"text-gray-700",children:"Password"}),e.jsx(l,{id:"passLogin",type:"password",name:"password",placeholder:"Enter your password",required:!0,className:"border border-gray-300"})]}),e.jsx(b,{type:"submit",className:"w-full bg-purple-500 text-white hover:bg-purple-600",disabled:m,children:m?"Signing in...":"Sign in"})]})]}),e.jsxs(y,{value:"signup",children:[n&&e.jsx(f,{variant:"destructive",className:"mb-4",children:e.jsx(N,{children:n})}),e.jsxs("form",{onSubmit:s=>g(s,"signup"),className:"space-y-4",children:[e.jsxs("div",{className:"mb-2 space-y-1",children:[e.jsx(i,{htmlFor:"name",className:"text-gray-700",children:"Full Name"}),e.jsx(l,{id:"name",type:"text",name:"name",placeholder:"Enter your full name",required:!0,className:"border border-gray-300"})]}),e.jsxs("div",{className:"mb-2 space-y-1",children:[e.jsx(i,{htmlFor:"email",className:"text-gray-700",children:"Email"}),e.jsx(l,{id:"email",type:"email",name:"email",placeholder:"Enter your email",required:!0,className:"border border-gray-300"})]}),e.jsxs("div",{className:"mb-2 space-y-1",children:[e.jsx(i,{htmlFor:"phone",className:"text-gray-700",children:"Phone Number"}),e.jsx(l,{id:"phone",type:"number",name:"phone",placeholder:"Enter your phone number",min:"10",required:!0,className:"border border-gray-300"})]}),e.jsxs("div",{className:"mb-2 space-y-1",children:[e.jsx(i,{htmlFor:"password",className:"text-gray-700",children:"Password"}),e.jsx(l,{id:"password",type:"password",name:"password",placeholder:"Create a password",required:!0,className:"border border-gray-300"})]}),e.jsx(b,{type:"submit",className:"w-full bg-purple-500 text-white hover:bg-purple-600",disabled:m,children:m?"Creating account...":"Create Account"})]})]})]})]})]})})};export{K as default};
